#!perl
#
# Tpda3 Application Development.
#

use strict;
use warnings;
use utf8;

use Tpda3::Devel;

if ( !@ARGV ) {
    Tpda3::Devel::usage(1);
    exit 1;
}

main();

sub main {
    my $opt = Tpda3::Devel::get_options();

    check_options($opt);

    Tpda3::Devel->new($opt)->process_command();
}

=head2 check_options

Check if list option and execute.

=cut

sub check_options {
    my $opt = shift;

    if ( defined $opt->{list} ) {
        require Tpda3::Devel::Info::Config;
        Tpda3::Devel::Info::Config->new->list_configs;
        exit;
    }
}

=head1 NAME

Tpda3 Application Development.

=head1 SYNOPSIS

Generate a new Tpda3 application:

   tpda3d <app-name> [-c <app-cfg>]

Generate a new Tpda3 screen module and screen configuration:

   tpda3d [<app-cfg>] -M <scr-name> -t <table> [-c <scr-cfg>]

Update a Tpda3 screen configuration:

   tpda3d [<app-cfg>] -U -c <scr-cfg>

Info:

 -l, --list                List available application configurations.
 -?  --help | -m, --man

=head1 DESCRIPTION

Utility program to create or extend Tpda3 application modules.

The current mode is automagicaly determined by checking if two paths
exists relative to the CWD: L<< lib/Tpda3/Tk/App >> and L<< share/apps >>.  If
the paths exists then enters in update mode, else in create mode.

=head2 Create mode

Create a new Tpda3 application module directory tree from template.

=head2 Update mode

Updates an existing application.  Create a new screen module and the
coresponding screen configuration, or update an existing screen
configuration to the current version.

Extract table informations from a database and create a basic screen
configuration file and a PerlTk screen module file.

The parameters are:

=over

=item  <scr-name>     required, the name of the new screen module

=item  <table>        required, the name of the main table

=item  [scr-cfg]      optional, the name of the screen config

=back

If the screen config name is not provided then is set to lower case of
the screen name.

=head1 CONFIGURATION AND ENVIRONMENT

Requirements:

    Tpda3 v0.46.

=head1 BUGS AND LIMITATIONS

There are no known bugs in this module.

Please report problems to the author(s)

Patches are welcome.

=head1 AUTHOR

Stefan Suciu, C<< <stefan@s2i2.ro> >>

=head1 LICENCE AND COPYRIGHT

Copyright (c) 2011-2012 Stefan Suciu.

All rights reserved.

GNU General Public License
